<div class="p-4 max-w-5xl mx-auto text-[var(--text-primary)]">

    <!-- ➕ Botón para abrir el modal -->
    <div class="flex justify-center mb-6">
        <button (click)="abrirFormulario()"
            class="inline-flex items-center gap-2 px-4 py-2 rounded-2xl shadow transition text-white bg-[var(--success)] hover:bg-[var(--success-hover)]">
            <span class="text-lg">➕</span>
            <span>Nuevo Cliente</span>
        </button>
    </div>

    <!-- 🖥️ Tabla para escritorio -->
    <div class="hidden md:grid auto-rows-auto bg-[var(--border-default)] rounded-xl overflow-hidden shadow text-[var(--text-primary)] text-sm"
        [style.gridTemplateColumns]="'repeat(' + (visibleFields().length + 1) + ', 1fr)'">
        @for (field of visibleFields(); track field.name) {
        <div class="bg-[var(--bg-muted)] p-3 font-medium text-[var(--text-secondary)]">
            {{ field.label }}
        </div>
        }
        <div class="bg-[var(--bg-muted)] p-3 font-medium text-[var(--text-secondary)]"></div>

        @for (cliente of clientes(); track cliente.id) {
        @for (field of visibleFields(); track field.name) {
            <div class="bg-[var(--bg-elevated)] p-3 border-t border-[var(--border-default)]">
                @if (field.name === 'estado') {
                <span [ngClass]="claseEstado(cliente.estado)">
                    {{ cliente.estado }}
                </span>
                } @else {
                {{ cliente[field.name] }}
                }
            </div>
              
        }
        <div class="bg-[var(--bg-elevated)] p-3 border-t border-[var(--border-default)] flex justify-end gap-2">
            <button (click)="abrirDetalle(cliente)"
                class="text-[var(--accent)] hover:text-[var(--accent-hover)]">👁️</button>
            <button (click)="abrirFormulario(cliente)"
                class="text-[var(--accent)] hover:text-[var(--accent-hover)]">✏️</button>
            <button (click)="confirmarEliminar(cliente)"
                class="text-[var(--danger)] hover:text-[var(--danger-hover)]">🗑️</button>
        </div>
        }
    </div>


    <!-- 📱 Vista móvil -->
    <ul class="md:hidden">
        @for (cliente of clientes(); track cliente.id) {
        <li class="mb-4 p-4 bg-[var(--bg-elevated)] text-[var(--text-primary)] rounded-2xl shadow flex flex-col gap-2">
            <div class="flex justify-between items-center">
                <strong class="text-lg font-semibold">{{ cliente[visibleFields()[0].name] }}</strong>
                <div class="flex gap-2">
                    <button (click)="abrirDetalle(cliente)"
                        class="text-[var(--accent)] hover:text-[var(--accent-hover)]">👁️</button>
                    <button (click)="abrirFormulario(cliente)"
                        class="text-[var(--accent)] hover:text-[var(--accent-hover)]">✏️</button>
                    <button (click)="confirmarEliminar(cliente)"
                        class="text-[var(--danger)] hover:text-[var(--danger-hover)]">🗑️</button>
                </div>
            </div>
            <div class="text-sm text-[var(--text-secondary)]">
                @for (field of visibleFields(); track field.name) {
                @if (field !== visibleFields()[0]) {
                <div>{{ field.label }}: <span class="text-[var(--text-primary)]">{{ cliente[field.name] }}</span></div>
                }
                }
            </div>
        </li>
        }
    </ul>

    <!-- 👁️ Detalle -->
    @if ( mostrarDetalle() && clienteSeleccionado() !== null) {
    <cliente-detail [cliente]="clienteSeleccionado()!" (cerrar)="cerrarDetalle()" />
    }

    <!-- 📝 Formulario -->
    @if (mostrarFormulario() && clienteAEditar() !== null) {
    <cliente-form [cliente]="clienteAEditar()!" (cerrado)="cerrarFormulario()" (guardarCliente)="guardar($event)" />
    }

    <!-- 🗑️ Confirmación -->
    @if (mostrarConfirmacion() && clienteAEliminar() !== null) {
    <confirmar-eliminacion [cliente]="clienteAEliminar()!" (cerrar)="cancelarEliminacion()"
        (confirmar)="eliminarConfirmado()" />
    }